#!/bin/bash
cd "$(dirname "$0")/.." || exit 111
source ./script/bootstrap || exit 111

arg1=$1

styles_root="./styles/books"

# Pull in the BOOK_CONFIGS and STYLE_NAMES
source ./books.txt || exit 1

if [ ! "${arg1}" == "" ]; then
  STYLE_NAMES=("${arg1} ${arg1}")
fi

sass_bin="$(npm bin)/sass"
output_dir="./styles/output"

for style_config in "${STYLE_NAMES[@]}"; do
  read -r style_name _ <<< "${style_config}"
  
  sass_file="${styles_root}/${style_name}/book.scss"
  css_file="${output_dir}/${style_name}.css"

  do_progress "Generating ${css_file}" \
    "${sass_bin}" --source-map "${sass_file}" "${css_file}"
  
done
