@function exerciseComponentsDisplay($exercisePart, $componentName, $selector) {
  $value: null;
  $partComponentName: null;

  @if $exercisePart == problem {
    $value: flex;
    $partComponentName: "Problem#{$componentName}";
  } @else if $exercisePart == solution {
    $value: inline;
    $partComponentName: "Solution#{$componentName}";
  } @else {
    @error "There is no such part in exercise"
  }

  @return (
    _name: "#{$partComponentName}",
    _subselector: #{$selector},
    _properties: (
      display: $value,
    )
  );
}

@function exercise($exercisePart) {
  @return map-merge(exerciseComponentsDisplay($exercisePart, Component, '> [data-type="#{$exercisePart}"]'), (
    _components: (
      map-merge(exerciseComponentsDisplay($exercisePart, Container, '> .os-#{$exercisePart}-container'), (
        _components: (
          exerciseComponentsDisplay($exercisePart, Text, '> p')
        )
      ))
    )
  ));
}

$AnswerKeyContainerComponent: (
  _name: "Container",
  _subselector: '',
  _properties: (

  )
);

$AnswerKeyTitleComponent: (
  _name: "TitleContainer",
  _subselector: ' > h1',
  _properties: (
    border-bottom-color: enum('ValueSet:::REQUIRED'),
    border-bottom-width: enum('ValueSet:::REQUIRED'),
    border-bottom-style: enum('ValueSet:::REQUIRED'),
    column-span: all,
    padding-bottom: enum('ValueSet:::OPTIONAL'),
    color: enum('ValueSet:::REQUIRED'),
    font-family: enum('ValueSet:::OPTIONAL'),
    font-size: enum('ValueSet:::REQUIRED'),
    line-height: enum('ValueSet:::REQUIRED'),
    font-weight: bold,
    text-transform: uppercase,
  )
);

$AnswerKeyTitleTextComponent: (
  _name: "Title",
  _subselector: ' > h2',
  _properties: (
    color: enum('ValueSet:::OPTIONAL'),
    font-family: enum('ValueSet:::OPTIONAL'),
    font-size: enum('ValueSet:::REQUIRED'),
    line-height: enum('ValueSet:::REQUIRED'),
    font-weight: normal,
  )
);

$AnswerKeyNumberComponent: (
  _name: "Number",
  _subselector: '> [data-type="solution"] > .os-number',
  _properties: (
    text-decoration: none,
    color: enum('ValueSet:::REQUIRED'),
  )
);

$AnswerKeyChapterContainerComponent: (
  _name: "ChapterContainer",
  _subselector: ' > [data-type="composite-page"]',
  _properties: (
    padding-bottom: enum('ValueSet:::OPTIONAL'),
  ),
  _components: (
    $AnswerKeyTitleTextComponent,
    exercise(solution),
    $AnswerKeyNumberComponent
  )
);
